<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.db.service.LogService">
    <resultMap id="LogMap" type="com.db.entity.Log">    
        <result column="log_id" property="logId" jdbcType="INTEGER" />    
         <result column="operation_id" property="operationId" jdbcType="INTEGER" />  
          <result column="operation_name" property="operationName" jdbcType="VARCHAR" />   
          <result column="operation_content" property="operationContent" jdbcType="VARCHAR" />  
          <result column="operation_result" property="operationResult" jdbcType="VARCHAR" /> 
          <result column="operation_type" property="operationType" jdbcType="VARCHAR" /> 
          <result column="modular" property="modular" jdbcType="VARCHAR" /> 
          <result column="start_time" property="startTime" /> 
          <result column="end_time" property="endTime"  /> 
          
         
    </resultMap>    
     <!-- limit #{pageNo},#{pageSize} -->
<select id="getLogList" resultMap="LogMap">
   select * from tb_log l where 1=1
     <if test="log.operationId != null and log.operationId != ''">
         and l.operation_id=#{log.operationId}
     </if>
   <if test="log.operationName != null and log.operationName != ''">
           and l.operation_name like CONCAT('%','${log.operationName}','%')
     </if>
    <if test="log.operationType != null and log.operationType != ''">
         and l.operation_type=#{log.operationType}
     </if>
     
      <if test="log.operationResult != null and log.operationResult != ''">
         and l.operation_result=#{log.operationResult}
     </if>
     
     <if test="log.operationResult != null and log.operationResult != ''">
         and l.operation_result=#{log.operationResult}
     </if>
     
       <if test="log.modular != null and log.modular != ''">
         and l.modular=#{log.modular}
     </if>
     
    <if test="statime != null and statime != ''">
         and l.start_time &gt;=#{statime}
     </if>
     <if test="endtime != null and endtime != ''">
         and l.end_time &lt;=#{endtime}
     </if> 
       order by l.start_time desc limit #{pageNo},#{pageSize}
</select>

<!-- 总条数 -->
<select id="getCount" resultType="int">
    select count(*) from tb_log l where 1=1
    <if test="log.operationId != null and log.operationId != ''">
         and l.operation_id=#{log.operationId}
     </if>
   <if test="log.operationName != null and log.operationName != ''">
           and l.operation_name like CONCAT('%','${log.operationName}','%')
     </if>
    <if test="log.operationType != null and log.operationType != ''">
         and l.operation_type=#{log.operationType}
     </if>
     
      <if test="log.operationResult != null and log.operationResult != ''">
         and l.operation_result=#{log.operationResult}
     </if>
     
     <if test="log.operationResult != null and log.operationResult != ''">
         and l.operation_result=#{log.operationResult}
     </if>
     
       <if test="log.modular != null and log.modular != ''">
         and l.modular=#{log.modular}
     </if>
     
    <if test="statime != null and statime != ''">
         and l.start_time &gt;=#{statime}
     </if>
     <if test="endtime != null and endtime != ''">
         and l.end_time &lt;=#{endtime}
     </if> 
</select>
<insert id="saveLog" parameterType="com.db.entity.Log">
    insert into tb_log (operation_id,operation_name,operation_content,operation_result,operation_type,modular,start_time,end_time) 
          values(#{operationId},#{operationName},#{operationContent},#{operationResult},#{operationType},#{modular},#{startTime},#{endTime})
</insert>
<delete id="deleteLogById" parameterType="Integer">
   delete from tb_log where log_id=#{logId}
</delete>
<select id="findLog" resultMap="LogMap">
    select * from tb_log where 1=1
    <if test="startTime != null and startTime !=''">
      and start_time &gt;=#{startTime}
    </if>
     <if test="endTime != null and endTime !=''">
      and end_time &lt;=#{endTime}
    </if>
</select>
<delete id="batchDelete" parameterType="Integer">
    delete from tb_log where log_id in
         <foreach item="item"  index="index" collection="ids" open="("
					separator="," close=")">
					#{item}
		</foreach>
</delete>
</mapper>