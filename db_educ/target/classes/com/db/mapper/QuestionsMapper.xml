<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.db.service.QuestionBankService">
	<resultMap id="QuestionsMap" type="com.db.entity.Questions">
		<result column="questions_id" property="questionsId" jdbcType="INTEGER" />
		<result column="subject" property="subject" jdbcType="INTEGER" />
		<result column="topic_type" property="topicType" jdbcType="INTEGER" />
		<result column="grade" property="grade" jdbcType="INTEGER" />
		<result column="class_no" property="classNo" jdbcType="INTEGER" />
		<result column="create_time" property="createTime" />
		<result column="update_time" property="updateTime" />
		<result column="knowledge_begin" property="knowledgeBegin" jdbcType="INTEGER" />
		<result column="knowledge_end" property="knowledgeEnd" jdbcType="INTEGER" />
		<result column="truth_answer" property="truthAnswer" jdbcType="VARCHAR" />
		<result column="question_source" property="questionSource" jdbcType="INTEGER" />
		<result column="question_desc" property="questionDesc" jdbcType="VARCHAR" />
		<result column="content_id" property="contentId" jdbcType="INTEGER" />
		<result column="answer_A" property="answerA" jdbcType="VARCHAR" />
		<result column="answer_B" property="answerB" jdbcType="VARCHAR" />
		<result column="answer_C" property="answerC" jdbcType="VARCHAR" />
		<result column="answer_D" property="answerD" jdbcType="VARCHAR" />
		<result column="material" property="material" jdbcType="INTEGER" />
		<result column="used_count" property="usedCount" jdbcType="INTEGER" />
		<result column="right_count" property="rightCount" jdbcType="INTEGER" />
		<result column="fault_count" property="faultCount" jdbcType="INTEGER" />
		<result column="entering_user" property="enteringUser" jdbcType="INTEGER" />
		<result column="tag_id" property="tagId" jdbcType="VARCHAR" />
		<result column="number" property="number" jdbcType="INTEGER" />
		<result column="score" property="score" jdbcType="INTEGER" />
		<result column="is_public" property="isPublic" jdbcType="INTEGER" />
		<result column="difficulty_value" property="difficultyValue" jdbcType="INTEGER" />	
	</resultMap>

<!-- 我的题库列表 -->
<select id="questionList" resultMap="QuestionsMap" parameterType="com.db.entity.Questions">
   select * from tb_questions where 1=1 and entering_user=#{teacherId}
   <!-- 模糊查询 -->
    <!-- <if test="subject!=null and subject !=''">
      	<![CDATA[ and subject=#{subject} ]]>
   </if> 
    <if test="topicType!=null and topicType !=''">
      	<![CDATA[ and topic_type=#{topicType} ]]>
   </if>
   <if test="score!=null and score !=''">
      	<![CDATA[ and score =#{score} ]]>
   </if>
    <if test="difficultyValue!=null and difficultyValue !=''">
      	<![CDATA[ and difficulty_value =#{difficultyValue} ]]>
   </if>
   <if test="isPublic!=null and isPublic !=''">
      	<![CDATA[ and is_public =#{isPublic} ]]>
   </if> -->
</select>

<select id="queryQuestionList" resultMap="QuestionsMap" parameterType="com.db.entity.Questions">
   select * from tb_questions where 1=1 and topic_type like CONCAT('%',#{topicType},'%') 
     <!--  and number like CONCAT('%',#{number},'%')  and score like CONCAT('%',#{score},'%') and tag_id like CONCAT('%',#{tagId},'%')  -->

 
</select>

<!-- 查看个人题库 -->
<select id="viewDetailsById" resultMap="QuestionsMap">
   select * from tb_questions where questions_id=#{questionsId}
</select>

<!-- 录入试题  -->
<insert id="addQuestionBank" parameterType="com.db.entity.Questions" >
       insert into tb_questions(subject,topic_type,grade,create_time,used_count,right_count,fault_count,entering_user,is_public
      <if test="classNo != null and classNo != ''">
            <![CDATA[,class_no]]>
      </if>
      <if test="updateTime != null and updateTime != ''">
                <![CDATA[,update_time]]>
      </if>
      <if test="knowledgeBegin != null and knowledgeBegin != ''">
                <![CDATA[,knowledge_begin]]>
      </if>
      <if test="knowledgeEnd != null and knowledgeEnd != ''">
                <![CDATA[,knowledge_end]]>
      </if>
      <if test="truthAnswer!=null and truthAnswer!=''">
            <![CDATA[,truth_answer]]>
      </if>
     <!--  <if test="questionSource != null and questionSource != ''">
                <![CDATA[,question_source]]>
      </if> -->
      <if test="questionDesc != null and questionDesc != ''">
                <![CDATA[,question_desc]]>
      </if>
      <if test="contentId != null and contentId != ''">
                <![CDATA[,content_id]]>
      </if>
      
       <if test="answerA != null and answerA != ''">
            <![CDATA[,answer_A]]>
      </if>
      <if test="answerB != null and answerB != ''">
                <![CDATA[,answer_B]]>
      </if>
      <if test="answerC != null and answerC != ''">
                <![CDATA[,answer_C]]>
      </if>
      <if test="answerD != null and answerD != ''">
                <![CDATA[,answer_D]]>
      </if>
       <if test="material != null and material != ''">
            <![CDATA[,material]]>
      </if>
      <if test="difficultyValue != null and difficultyValue != ''">
                <![CDATA[,difficulty_value]]>
      </if>
      <if test="tagId != null and tagId != ''">
                <![CDATA[,tag_id]]>
      </if>
       )
       values(#{subject},#{topicType},#{grade},#{createTime},#{usedCount},#{rightCount},#{faultCount},#{enteringUser},#{isPublic}
       <if test="classNo != null and classNo != ''">
            <![CDATA[,#{classNo}]]>
      </if>
      <if test="updateTime != null and updateTime != ''">
                <![CDATA[,#{updateTime}]]>
      </if>
      <if test="knowledgeBegin != null and knowledgeBegin != ''">
                <![CDATA[,#{knowledgeBegin}]]>
      </if>
      <if test="knowledgeEnd != null and knowledgeEnd != ''">
                <![CDATA[,#{knowledgeEnd}]]>
      </if>
      <if test="truthAnswer!=null and truthAnswer!=''">
            <![CDATA[,#{truthAnswer}]]>
      </if>
     <!--  <if test="questionSource!=null and questionSource!=''">
                <![CDATA[,questionSource]]>
      </if> -->
      <if test="questionDesc != null and questionDesc != ''">
                <![CDATA[,#{questionDesc}]]>
      </if>
      <if test="contentId != null and contentId != ''">
                <![CDATA[,#{contentId}]]>
      </if>
      
       <if test="answerA != null and answerA != ''">
            <![CDATA[,#{answerA}]]>
      </if>
      <if test="answerB != null and answerB != ''">
                <![CDATA[,#{answerB}]]>
      </if>
      <if test="answerC != null and answerC != ''">
                <![CDATA[,#{answerC}]]>
      </if>
      <if test="answerD!=null and answerD!=''">
                <![CDATA[,#{answerD}]]>
      </if>
       <if test="material!=null and material!=''">
            <![CDATA[,#{material}]]>
      </if>
      <if test="difficultyValue!=null and difficultyValue!=''">
                <![CDATA[,#{difficultyValue}]]>
      </if>
      <if test="tagId!=null and tagId!=''">
                <![CDATA[,#{tagId}]]>
      </if>
       )
</insert>
<!-- 删除题库 -->
<delete id="deleteQuestion" parameterType="java.lang.Integer">
  delete from tb_questions where questions_id=#{questionsId}
</delete>

<!-- 修改题库 -->
<update id="updateQuestionsById" parameterType="com.db.entity.Questions">
  update tb_questions set truth_answer=#{truthAnswer},answer_A=#{answerA},answer_B=#{answerB},answer_C=#{answerC},answer_D=#{answerD},question_desc=#{questionDesc},question_source#{questionSource},tag_id=#{tagId}  
           where questions_id=#{questionsId}

</update>
</mapper>